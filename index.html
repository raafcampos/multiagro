<!DOCTYPE html>
<html lang="es">
<!-- O atributo lang="es" define o idioma principal da página como espanhol s -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-lang-es="Multiagro | Granos de Calidad para el Mundo"
           data-lang-en="Multiagro | Quality Grains for the World"
           data-lang-pt="Multiagro | Grãos de Qualidade para o Mundo">Multiagro | Granos de Calidad para el Mundo</title>
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Font Awesome para ícones -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
       integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <style>
        /* Definição de variáveis CSS (Custom Properties) para o tema do site */
        :root {
            /* Verde um pouco mais escuro */
            --verde-principal: hsl(140, 40%, 28%); /* Ajustado para mais escuro */
            --verde-escuro: hsl(140, 40%, 35%);   /* Ajustado para mais escuro */
            --verde-claro: hsl(140, 60%, 88%);   /* Levemente ajustado */
            
            --lilas-principal: hsl(270, 50%, 55%); /* Lilás um pouco menos vibrante para combinar */
            --lilas-escuro: hsl(270, 50%, 40%);
            --lilas-claro: hsl(270, 60%, 95%);
            
            --preto-azulado: hsl(220, 15%, 15%); /* Preto com leve tom azulado */
            --cinza-muito-escuro: hsl(0, 0%, 10%);
            --cinza-texto: #333;
            --cinza-fundo: #f9f9f9;
            --branco: #fff;
            
            --sombra: 0 5px 15px rgba(0,0,0,0.1);
            --sombra-leve: 0 2px 8px rgba(0,0,0,0.07);

            --transicao-padrao: all 0.3s ease-in-out;
        }

        /* Reset básico e box-sizing */
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            /* Habilita a rolagem suave para links de âncora */
            scroll-behavior: smooth;
        }

        body {
            /* Estilos base para o corpo da página */
            font-family: 'Montserrat', sans-serif;
            background-color: var(--cinza-fundo);
            color: var(--cinza-texto);
            line-height: 1.7;
            font-size: 16px;
        }

        header {
            /* Estilos do cabeçalho principal */
            background-color: var(--verde-principal);
            color: var(--branco);
            padding: 1rem 1.5rem; /* Reduzido um pouco para acomodar o seletor de idioma */
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--sombra-leve);
            transition: var(--transicao-padrao);
        }
        /* Container para a bandeira do Paraguai */
        .paraguay-flag-container {
            display: flex;
            align-items: center;
        }
        /* Estilos para a bandeira do Paraguai com efeito de gradiente e sombra */
        .paraguay-flag {
            width: 36px;
            height: 24px;
            background: linear-gradient(to bottom, #d52b1e 33.33%, #ffffff 33.33% 66.66%, #0038a8 66.66%);
            margin-right: 15px; /* Levemente aumentado para acomodar a sombra e rotação */
            transform: rotate(-7deg); /* Inclinação para a esquerda */
            box-shadow: 
                /* Sombra base para profundidade, considerando a rotação */
                1px 1px 4px rgba(0, 0, 0, 0.25), 
                /* Camadas de brilho "flamejante" */
                0 0 7px 2px rgba(255, 69, 0, 0.6),  /* Laranja-avermelhado intenso (como uma brasa) */
                0 0 14px 4px rgba(255, 165, 0, 0.4); /* Laranja mais suave externo (como uma chama) */
            transition: transform 0.3s ease-out, box-shadow 0.3s ease-out; /* Transição suave */
        }
        /* Efeito hover para a bandeira */
        .paraguay-flag:hover {
            transform: rotate(-5deg) scale(1.1); /* Endireita um pouco e aumenta no hover */
            box-shadow: 
                2px 2px 6px rgba(0, 0, 0, 0.3),
                0 0 10px 3px rgba(255, 69, 0, 0.75), /* Brilho mais intenso */
                0 0 20px 6px rgba(255, 165, 0, 0.55); /* Brilho mais amplo */
        }
        /* Container do conteúdo do cabeçalho (logo e navegação) */
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        .logo {
            display: flex; /* Para alinhar a imagem se necessário */
            align-items: center;
        }
        .logo a { /* Estilos para o texto do logo "Multiagro" */
            font-size: 2rem;
            font-weight: 700;
            color: var(--branco);
            text-decoration: none;
            letter-spacing: 1px;
        }
        /* .logo img {
            height: 65px; /* Ajuste a altura conforme necessário */
            /* width: auto; */ /* Mantém a proporção */
        /* } */

        nav ul {
            /* Estilos da lista de navegação */
            list-style: none;
            display: flex;
            align-items: center; /* Alinhar itens incluindo o seletor de idioma */
        }

        nav a {
            /* Estilos dos links de navegação */
            color: var(--branco);
            margin: 0 0.8rem; /* Espaçamento ajustado */
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem; /* Tamanho ajustado */
            padding-bottom: 0.5rem;
            border-bottom: 3px solid transparent;
            transition: var(--transicao-padrao);
        }

        /* Estilo para link ativo ou em hover */
        nav a:hover, nav a.active {
            color: var(--lilas-claro);
            border-bottom-color: var(--lilas-principal);
        }
        
        /* Seletor de idioma */
        .language-switcher {
            margin-left: 1rem;
            font-size: 0.85rem;
        }
        .language-switcher button {
            /* Estilos dos botões de idioma */
            background: none;
            border: 1px solid var(--lilas-claro);
            color: var(--branco); /* Alterado para branco para melhor contraste inicial */
            padding: 0.3rem 0.6rem;
            border-radius: 15px; /* Mais arredondado */
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-weight: 500;
            margin: 0 0.2rem;
            transition: var(--transicao-padrao);
        }
        /* Estilo para botão de idioma ativo ou em hover */
        .language-switcher button:hover, .language-switcher button.active-lang {
            background-color: var(--lilas-principal);
            color: var(--branco);
            border-color: var(--lilas-principal);
        }

        /* Estilos para o link de navegação de Investidores */
        nav a.nav-link-investor { /* Estilo especial para o link "Inversionistas" parecer um botão */
            background-image: linear-gradient(to bottom, hsl(220, 15%, 22%), hsl(220, 15%, 12%)); /* Gradiente sutil escuro */
            color: var(--lilas-claro);
            padding: 0.6rem 1.2rem; /* Padding para dar forma de botão */
            border-radius: 25px; /* Efeito pílula */
            border-bottom: none; /* Remover a borda inferior padrão dos links de navegação */
            margin-left: 0.8rem; /* Manter algum espaçamento dos outros itens */
            box-shadow: 0 1px 3px rgba(0,0,0,0.3), inset 0 1px 1px rgba(255,255,255,0.08); /* Sombra externa e interna sutil */
            transition: var(--transicao-padrao), background-image 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease; /* Adicionar transições específicas */
        }

        /* Efeito hover e ativo para o link de Investidores */
        nav a.nav-link-investor:hover,
        nav a.nav-link-investor.active {
            background-image: linear-gradient(to bottom, hsl(220, 15%, 28%), hsl(220, 15%, 18%)); /* Gradiente um pouco mais claro no hover/active */
            color: var(--branco);
            box-shadow: 0 2px 5px rgba(0,0,0,0.35), inset 0 1px 1px rgba(255,255,255,0.1);
            border-bottom: none; /* Garantir que a borda inferior não reapareça */
            transform: translateY(-1px); /* Leve elevação no hover */
        }


        /* Botão de menu hambúrguer para telas menores */
        .menu-toggle {
            display: none; 
            font-size: 1.5rem;
            background: none;
            border: none;
            color: var(--branco);
            cursor: pointer;
            padding: 0.3rem 0.5rem; /* Adicionado padding */
            border-radius: 8px; /* Levemente arredondado */
        }

        main {
            /* Estilos do conteúdo principal da página */
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: var(--branco);
            border-radius: 12px;
            box-shadow: var(--sombra);
        }

        /* Oculta todas as seções por padrão */
        main section {
            display: none;
        }

        /* Mostra a seção ativa que não é a hero section */
        main section.visible {
            display: block;
        }

        section {
            /* Estilos base para cada seção de conteúdo */
            padding: 2.5rem 0; /* Aumentado o padding vertical */
            border-bottom: 1px solid var(--verde-claro);
        }
        section:last-of-type {
            border-bottom: none;
        }

        /* Seção Hero (principal, no topo) */
        .hero-section {
            padding: 0; /* Removido padding para o carrossel ocupar tudo */
            /* border-radius: 12px; */ /* Movido para o carrossel */
            text-align: center;
            margin-bottom: 2.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start; /* Alinha itens ao topo */
            position: relative; /* Para o carrossel absoluto e o conteúdo */
            min-height: 200px; /* Altura mínima aumentada para acomodar logo + carrossel */
            background-color: var(--branco); /* Fundo para a seção hero, onde a logo ficará */
        }

        /* Nova área para o conteúdo principal da Hero (carrossel + texto) */
        .hero-main-content-area {
            position: relative;
            width: 100%;
            margin: 0 auto 2rem auto; /* Centralizado e com margem inferior */
            border-radius: 12px; /* Mantido */
            overflow: hidden; /* Para cortar o carrossel nos cantos arredondados */
            height: 0; /* Necessário para o truque de padding-bottom do aspect ratio */
            padding-bottom: 50%; /* Proporção 16:8 ou 2:1 (8 / 16 * 100) */
        }

        /* Mostra a seção ativa (Hero usa flex, outras usam block) */
        .hero-section.visible {
            display: flex;
        }
        /* Classe para ocultar a hero section em subpáginas via JavaScript */
        .hero-hidden-on-subpage {
            display: none !important;
        }
        .hero-carousel {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0; /* Atrás do hero-content-overlay */
            border-radius: 12px;
        }
        /* Container dos slides do carrossel */
        .carousel-slides {
            display: flex;
            height: 100%;
            transition: transform 0.7s ease-in-out;
        }
        /* Estilo individual de cada slide */
        .carousel-slide {
            min-width: 100%;
            flex-shrink: 0;
            height: 100%;
            position: relative; /* Para o overlay */
        }
        .carousel-slide img {
            width: 100%;
            height: 100%;
            object-fit:cover; /* Ensures the entire image is visible, scaled down to fit */
            display: block;
            background-color: var(--cinza-muito-escuro); /* Fills empty space if aspect ratios differ */
        }
        .carousel-slide::after { /* Overlay para contraste do texto */
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(158, 158, 158, 0.45); /* Dark overlay for text contrast on each slide */
            z-index: 1;
        }
        /* Botões de navegação do carrossel (anterior/próximo) */
        .carousel-prev, .carousel-next {
            z-index: 3; /* Acima do hero-content-overlay */
        }
        .carousel-prev { left: 20px; }
        .carousel-next { right: 20px; }
        .carousel-prev:hover, .carousel-next:hover {
            background-color: rgba(0, 0, 0, 0.4);
        }

        .slide-product-caption {
            position: absolute;
            bottom: 25px;
            left: 25px;
            /* z-index: 2; */ /* Ajustado para z-index: 3 se for sobrepor o overlay ::after */
            z-index: 3; 
            color: var(--branco);
            background-color: rgba(0, 0, 0, 0.55); /* Fundo semi-transparente para a legenda */
            padding: 0.6rem 1rem;
            border-radius: 8px;
            max-width: calc(100% - 50px); /* Evitar que a legenda seja muito larga */
        }

        .slide-product-caption h4 {
            margin: 0;
            font-size: 1.6rem; /* Tamanho do nome do produto no slide */
            font-weight: 600;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.7);
        }

        /* Conteúdo de texto sobreposto ao carrossel na seção Hero */
        .hero-content-overlay {
            position: absolute; /* Alterado para absoluto para sobrepor cada slide */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%; /* Ocupa toda a altura do slide pai */
            z-index: 2; /* Acima do overlay ::after do slide, abaixo dos botões de navegação do carrossel */
            padding: 2rem; /* Padding geral para o conteúdo de texto */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center; /* Centraliza o conteúdo verticalmente */
            box-sizing: border-box;
        }
        /* Garante que o conteúdo da hero section esteja visível quando a seção está visível */
        .hero-section.visible .hero-content-overlay {
             display: flex; /* Garante que o conteúdo flexível apareça */
        }
        /* Estilo para a logo principal na seção Hero */
        .hero-logo-main { /* Agora estiliza o texto "Multiagro" */
            font-size: 6.37rem; /* Tamanho da fonte aumentado em 15% (3.8 * 1.15) */
            font-weight: 700; /* Negrito */
            color: var(--verde-principal); /* Cor verde principal */
            text-shadow: 1px 1px 3px var(--verde-escuro); /* Sombra verde escura para legibilidade */
            margin-top: 1.5rem; /* Espaço acima da logo, abaixo do header */
            margin-bottom: 1.5rem; /* Espaço entre a logo e o conteúdo de texto abaixo (H1) */
            text-align: center; /* Centraliza o texto */
        }
        
        /* Título principal da seção Hero */
        .hero-section h1 {
            font-size: 2.6rem; /* Ajustado */
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--branco);
            text-shadow: 1px 1px 4px rgba(0,0,0,0.6); /* Sombra mais forte para legibilidade */
        }

        /* Subtítulo da seção Hero */
        .hero-section p.subtitle {
            font-size: 1.35rem; /* Ajustado */
            max-width: 750px;
            margin-bottom: 2rem;
            font-weight: 500;
            color: var(--branco); /* Adicionado para garantir cor branca */
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5); /* Sombra para legibilidade */
        }
        
        /* Botão Call-to-Action (CTA) na seção Hero */
        .hero-section .cta-btn {
            background-color: var(--branco);
            color: var(--verde-principal);
            font-weight: 600;
            position: relative; /* Mantido, z-index é relativo ao .hero-content-overlay */
            z-index: 2;
        }
        .hero-section .cta-btn:hover {
            background-color: var(--verde-claro); /* Interação com cor da paleta */
            color: var(--lilas-escuro);
        }

        /* Container para os cards de produtos */
        .product-cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); /* Grade responsiva */
            gap: 1.5rem; /* Espaçamento entre os cards */
            margin-top: 2rem;
            margin-bottom: 2.5rem; /* Espaço antes do mapa */
        }

        /* Card individual de produto */
        .product-card {
            background-color: var(--lilas-claro);
            border-radius: 10px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--sombra-leve);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between; /* Para alinhar conteúdo se descrições variarem */
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--sombra);
        }
        /* Estilos para as imagens dos produtos nos cards */
        .product-card img { 
            width: 200px; /* Tamanho da imagem do produto */
            height: auto;
            object-fit: scale-down;
            border-radius: 8%; /* Imagens redondas */
            margin: 0 auto 4rem auto; /* Centralizado */
            border: 0px solid var(--verde-principal); 
        }
        .product-card h4 {
            color: var(--lilas-escuro);
            margin-bottom: 0.5rem;
            font-size: 1.25rem;
        }
        .product-card p {
            font-size: 0.9rem;
            color: var(--cinza-texto);
            flex-grow: 1; /* Para que os cards tenham altura similar se as descrições variarem */
            margin-bottom: 0; /* Remover margem inferior padrão do parágrafo se não houver botão */
        }
        .product-thumbnail-nav {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem; /* Espaço entre miniaturas */
            padding: 1rem 0;
            max-width: 900px; /* Limita a largura da navegação de miniaturas */
            width: 100%;
        }
        .product-thumbnail-nav .product-card.active-thumbnail {
            border-color: var(--lilas-principal);
            box-shadow: 0 0 12px rgba(128, 0, 128, 0.5); /* Sombra lilás mais pronunciada */
            transform: scale(1.05); /* Leve aumento para destacar */
        }
        .product-thumbnail-nav .product-card.active-thumbnail img {
            border-color: var(--lilas-principal);
        }

        /* Legenda do Mapa */
        .map-legend {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 1.5rem; /* Espaço entre os itens da legenda */
            margin-top: 1.25rem; /* Espaço acima da legenda */
            padding: 0.75rem;
            background-color: var(--lilas-claro); /* Fundo sutil para a legenda */
            border-radius: 8px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
        }
        .legend-color-box {
            width: 18px;
            height: 18px;
            margin-right: 8px;
            border-radius: 4px;
            border: 1px solid rgba(0,0,0,0.1);
        }
        /* Container para os cards de estatísticas */
        .stats-cards {
            display: flex;
            justify-content: space-around;
            gap: 1.5rem;
            flex-wrap: wrap;
            margin: 2.5rem 0;
        }

        /* Card individual de estatística */
        .stat-card {
            background-color: var(--verde-claro);
            border-radius: 10px;
            padding: 1.5rem;
            flex: 1 1 220px;
            min-width: 180px;
            text-align: center;
            box-shadow: var(--sombra-leve);
            border-left: 5px solid var(--verde-principal);
        }
        .stat-card h4 {
            color: var(--verde-escuro);
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }
        .stat-card p.stat-value { /* Classe específica para o valor */
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--verde-escuro);
        }

        /* Botão Call-to-Action (CTA) genérico */
        .cta-btn {
            display: inline-block;
            background-color: var(--lilas-principal);
            color: var(--branco);
            padding: 0.8rem 1.8rem;
            border-radius: 50px;
            font-size: 1rem;
            text-decoration: none;
            font-weight: 600;
            letter-spacing: 0.5px;
            box-shadow: var(--sombra-leve);
            transition: var(--transicao-padrao);
            border: none;
            cursor: pointer;
        }
        .cta-btn:hover {
            background-color: var(--lilas-escuro);
            transform: translateY(-2px);
            box-shadow: var(--sombra);
        }
        /* Variação de cor para o botão CTA */
        .cta-btn.green { /* Botão verde alternativo */
            background-color: var(--verde-principal);
        }
        .cta-btn.green:hover {
            background-color: var(--verde-escuro);
        }

        /* Estilo para títulos de seção (H2) */
        h2 {
            font-size: 2rem;
            margin-bottom: 1.5rem;
            color: var(--verde-escuro);
            text-align: center;
            position: relative;
            padding-bottom: 0.5rem;
        }
        /* Linha decorativa abaixo do H2 */
        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background-color: var(--lilas-principal);
            border-radius: 2px;
        }
        
        /* Estilo para subtítulos (H3) */
        h3 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            color: var(--lilas-escuro);
        }
        
        /* Parágrafo introdutório para seções */
        p.section-intro { /* Parágrafo introdutório para seções */
            text-align: center;
            max-width: 800px;
            margin: 0 auto 2rem auto;
            font-size: 1.05rem;
            color: var(--cinza-texto);
        }

        /* Lista personalizada */
        ul.custom-list {
            list-style: none;
            padding-left: 0;
        }
        /* Itens da lista personalizada */
        ul.custom-list li {
            padding: 0.7rem 0.5rem; /* Padding ajustado */
            border-bottom: 1px dashed var(--verde-claro);
            display: flex; /* Para ícones no futuro */
            align-items: center;
        }
        /* Removed empty ruleset for ul.custom-list li::before */
        ul.custom-list li:last-child {
            border-bottom: none;
        }
        /* Links dentro da lista personalizada */
        ul.custom-list a {
            color: var(--verde-escuro);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }
        ul.custom-list a:hover {
            color: var(--lilas-principal);
            text-decoration: underline;
        }
        
        /* Estilos para os segmentos de produtos */
        .product-segment {
            margin-top: 3rem; /* Espaço entre os segmentos */
            padding-top: 2rem;
            border-top: 1px solid var(--verde-claro);
        }
        .product-segment:first-of-type {
            margin-top: 1.5rem; /* Menor margem para o primeiro segmento */
            padding-top: 0;
            border-top: none;
        }
        .product-segment h3 { /* Subtítulos dos segmentos */
            text-align: left;
            color: var(--lilas-escuro);
            margin-bottom: 1rem;
            font-size: 1.6rem;
        }
        .segment-intro { /* Parágrafo introdutório para cada segmento */
            font-size: 1rem;
            margin-bottom: 1.5rem;
            color: var(--cinza-texto);
        }
        .coming-soon-container { /* Container para itens "Em Breve" */
            text-align: center;
            padding: 2rem;
            background-color: var(--lilas-claro);
            border-radius: 10px;
        }
        .coming-soon-container img {
            width: 400px;/* Tamanho da imagem do produto */
            height: aulto;
            object-fit: scale-down;
            border-radius: 4%; /* Imagens redondas */
            margin: 0 auto 1rem auto; /* Centralizado */
            border: 0px solid var(--verde-principal); 
        }
        .coming-soon-text {
            font-size: 1.3rem;
            font-weight: 500;
            color: var(--lilas-escuro);
        }

        /* Estilos para o vídeo de fundo na seção "Sobre Nós" */

        .video-background-container {
            width: 100%;
            height: 400px; /* Altura definida para o bloco do vídeo. Ajuste conforme necessário. */
            overflow: hidden;
            margin: 2rem 0; /* Adiciona espaço vertical ao redor do vídeo */
            border-radius: 8px; /* Opcional: para cantos arredondados no container do vídeo */
            background-color: var(--cinza-muito-escuro); /* Cor de fundo caso o vídeo demore a carregar */
        }
        .video-background-container video {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Faz o vídeo cobrir todo o container, cortando se necessário */
        }
        .faq dt {
            font-weight: 600;
            color: var(--lilas-escuro);
            margin-top: 1rem;
            cursor: pointer; 
            padding: 0.5rem;
            background-color: var(--lilas-claro);
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        .faq dt:hover {
            background-color: hsl(270, 60%, 90%);
        }
        .faq dd {
            margin-left: 0;
            padding: 0.8rem 1rem; /* Padding aumentado */
            border-left: 3px solid var(--verde-claro);
            background-color: #fdfcff; /* Fundo levemente lilás */
            margin-bottom: 0.5rem;
        }
        /* Wrapper para o conteúdo da seção "Sobre Nós" ficar acima do vídeo */
       /* Formulário de contato */
        form {
            display: flex;
            flex-direction: column;
            max-width: 600px; /* Aumentado */
            margin: 1.5rem auto;
        }
        /* Labels do formulário */
        form label {
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--verde-escuro);
        }
        form input, form textarea {
            margin-bottom: 1rem;
            padding: 0.8rem;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-family: inherit;
            font-size: 0.95rem;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }
        form input:focus, form textarea:focus {
            outline: none;
            border-color: var(--lilas-principal);
            box-shadow: 0 0 0 2px var(--lilas-claro);
        }
        form button { 
            align-self: flex-start;
        }
        
        /* Informações de contato */
        .contact-info {
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: var(--lilas-claro); /* Cor de fallback ou base */
            border-radius: 8px;
            text-align: center;
            position: relative; /* Para posicionar o vídeo de fundo */
            overflow: hidden; /* Para cortar o vídeo nos cantos arredondados */
        }
        .contact-video-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Atrás do conteúdo */
        }
        .contact-video-bg video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.25; /* Ajuste a transparência aqui (0.0 a 1.0) */
        }
        .contact-info-overlay-content {
            position: relative;
            z-index: 1; /* Acima do vídeo */
        }
        /* Ajuste opcional de cor para melhor contraste sobre o vídeo */
        .contact-info-overlay-content p,
        .contact-info-overlay-content strong,
        .contact-info-overlay-content a {
            /* color: var(--preto-azulado); /* Exemplo se o vídeo for muito claro */
        }
        .contact-info strong {
            color: var(--lilas-escuro);
        }
        .contact-info p {
            margin-bottom: 0.5rem;
        }
        .contact-info a {
            color: var(--lilas-escuro);
            text-decoration: none;
        }
        .contact-info a:hover {
            text-decoration: underline;
        }
        /* Estilos para links de redes sociais na seção de contato */
        .contact-info .social-media-links {
            margin-top: 1.5rem; /* Espaço acima dos links sociais */
            padding-top: 1rem;
            border-top: 1px solid var(--lilas-principal); /* Linha separadora sutil */
        }
        .contact-info .social-media-links p strong { /* Para o título "Siga-nos em:" */
            display: block;
            margin-bottom: 0.75rem;
            font-size: 1.05rem;
            color: var(--lilas-escuro);
        }
        .contact-info .social-media-links a {
            display: inline-flex; /* Para alinhar ícone e texto verticalmente */
            align-items: center;
            margin: 0.3rem 0.8rem; /* Espaçamento entre os links */
            color: var(--lilas-escuro);
            text-decoration: none;
            font-size: 0.95rem;
        }
        .contact-info .social-media-links a i {
            margin-right: 0.5rem; /* Espaço entre o ícone e o texto */
            font-size: 1.3rem; /* Tamanho do ícone */
        }

        /* Estilos específicos para a seção de Investidores com tons escuros */
        #inversionistas {
            background-color: var(--preto-azulado); /* Alterado para preto/cinza escuro */
            color: var(--lilas-claro); /* Cor de texto base clara para contraste */
            border-radius: 10px;
            padding: 2.5rem; /* Manter padding interno */
            margin-bottom: 2.5rem; /* Espaçamento igual às outras seções */
            /* Esta seção tem um tema escuro para se destacar */
        }

        #inversionistas h2,
        #inversionistas h3 {
            color: var(--branco); /* Títulos em branco para destaque */
        }
        #inversionistas h2::after { /* Ajustar cor do sublinhado do título principal da seção */
            background-color: var(--lilas-claro); /* Sublinhado em cor clara */
        }

        #inversionistas p,
        #inversionistas ul.custom-list li,
        #inversionistas .faq dt,
        #inversionistas .faq dd,
        #inversionistas p.section-intro {
            color: hsl(270, 30%, 85%); /* Um lilás/cinza mais suave para parágrafos */
        }

        #inversionistas ul.custom-list a {
            color: var(--lilas-claro); /* Links em cor clara */
            font-weight: 500;
        }
        #inversionistas ul.custom-list a:hover {
            color: var(--branco); /* Hover do link para branco */
        }

        #inversionistas .faq dt {
            background-color: var(--cinza-muito-escuro); /* Fundo do FAQ dt mais escuro */
            color: var(--lilas-claro);
        }
        #inversionistas .faq dt:hover {
            background-color: hsl(0, 0%, 15%); /* Hover do FAQ dt */
        }
        #inversionistas .faq dd {
            background-color: hsl(220, 15%, 20%); /* Fundo do FAQ dd um pouco mais claro que o principal */
            border-left-color: var(--lilas-claro); /* Borda clara */
        }
        #inversionistas .cta-btn { /* Ajustar botões dentro da seção de investidores se necessário */
            background-color: var(--lilas-principal);
            color: var(--branco);
        }
        #inversionistas .cta-btn:hover {
            background-color: var(--lilas-escuro);
        }

        /* Imagem/gráfico ilustrativo na seção de investidores */
        .ri-graphic {
            width: 100%;
            max-width: 700px;
            display: block;
            margin: 2rem auto;
            border-radius: 10px;
            box-shadow: var(--sombra);
        }
        #inversionistas .ri-graphic {
            border: 2px solid hsl(270, 30%, 70%); /* Borda sutil para o gráfico */
        }

        /* Bloco de informações sobre a Bolsa de Valores */
        .bolsa-info {
            background-color: var(--cinza-muito-escuro); /* Fundo da info da bolsa mais escuro */
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2.5rem; /* Espaçamento antes do próximo conteúdo */
            text-align: center;
            border: 1px solid hsl(0, 0%, 25%); /* Borda sutil */
        }
        /* Logo da Bolsa de Valores */
        .bolsa-logo {
            /* Ajuste para garantir que o logo da bolsa apareça */
            display: block;
            max-width: 180px;
            margin-bottom: 1rem;
            margin-left: auto;
            margin-right: auto;
        }
        .bolsa-info p {
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
        }
        .bolsa-info a { /* Estilo específico para o link da bolsa */
            color: var(--lilas-claro); /* Link da bolsa em cor clara */
        }

        /* Rodapé da página */
        footer {
            background-color: var(--verde-escuro);
            color: var(--lilas-claro);
            padding: 2.5rem 1.5rem;
            text-align: center;
            font-size: 0.9rem;
            margin-top: 3rem;
        }
        footer p {
            margin-bottom: 0.8rem;
        }
        /* Links no rodapé */
        .footer-links a {
            color: var(--branco);
            margin: 0 0.7rem;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        .footer-links a:hover {
            color: var(--lilas-principal);
            text-decoration: underline;
        }
        /* Estilo para ícones de redes sociais no rodapé */
        .footer-links a .fab {
            font-size: 1.3rem; /* Tamanho dos ícones sociais no rodapé */
        }

        /* Media Queries para Responsividade */
        /* Para tablets e desktops menores */
        @media (max-width: 1024px) { /* Ajustado breakpoint para nav */
            .menu-toggle {
                display: block; 
                z-index: 1001; 
            }
            /* Estilos do menu de navegação mobile (hambúrguer) */
            nav ul {
                display: none; 
                flex-direction: column;
                align-items: flex-start; /* Alinhar itens à esquerda */
                position: fixed;
                top: 0;
                left: -100%; 
                width: 80%; /* Aumentado */
                max-width: 320px; /* Máximo */
                height: 100vh;
                background-color: var(--verde-escuro); /* Um pouco mais escuro para contraste com itens */
                padding-top: 5rem; /* Aumentado espaço */
                transition: left 0.4s ease-in-out;
                box-shadow: 5px 0 15px rgba(0,0,0,0.2);
                z-index: 999;
                border-top-right-radius: 25px; /* Canto superior direito arredondado */
                border-bottom-right-radius: 25px; /* Canto inferior direito arredondado */
            }
            /* Quando o menu mobile está ativo (aberto) */
            nav ul.active {
                display: flex;
                left: 0; 
            }
            nav li {
                width: calc(100% - 2rem); /* Ajustar largura para acomodar margens */
                margin: 0.3rem 1rem; /* Adicionar margem para espaçar e mostrar o arredondamento */
            }
            /* Links dentro do menu mobile */
            nav a {
                display: block;
                padding: 0.8rem 1.5rem; /* Padding ajustado */
                margin: 0;
                font-size: 1rem;
                /* border-bottom: 1px solid var(--verde-escuro); */ /* Removida borda inferior */
                width: 100%;
                border-radius: 10px; /* Arredondar os links */
                color: var(--lilas-claro); /* Cor do texto dos links */
            }
            nav a:hover, nav a.active {
                background-color: var(--verde-principal); /* Fundo no hover/active */
                color: var(--branco); /* Texto branco no hover/active */
            }
            /* Seletor de idioma no menu mobile */
            .language-switcher {
                margin: 1rem 0 1rem 1.5rem; /* Posicionamento no menu mobile, alinhado com padding de 'nav a' */
                align-self: flex-start;
            }

            /* Ajustes para o link de investidores no menu mobile */
            nav ul li a.nav-link-investor {
                /* Resetar para o estilo padrão dos links no menu mobile */
                background-image: none;
                background-color: transparent; 
                color: var(--lilas-claro); /* Cor inicial do link de investidor */
                padding: 0.8rem 1.5rem; 
                border-radius: 0;
                box-shadow: none;
                margin-left: 0; 
                /* border-bottom: 1px solid var(--verde-escuro); */ /* Removida borda */
                transform: none; 
                border-radius: 10px; /* Arredondar como os outros links */
            }
            nav ul li a.nav-link-investor:hover,
            nav ul li a.nav-link-investor.active {
                background-color: var(--verde-principal); /* Fundo no hover/active */
                color: var(--branco); /* Texto branco no hover/active */
            }
        }

        /* Para tablets menores e celulares em paisagem */
        @media (max-width: 768px) {
            header { padding: 1rem; }
            .logo { font-size: 1.6rem; }
            /* .logo img { height: 40px; } */ /* Ajuste da altura do logo para telas menores */
            .logo a { font-size: 1.6rem; } /* Ajuste do tamanho da fonte do logo para telas menores */
            main {
                margin: 1rem auto;
                padding: 1.5rem 1rem; /* Padding ajustado */
            }
            .hero-section { padding: 3rem 1rem; }
            .hero-section h1 { font-size: 2rem; }
            .hero-section p.subtitle { font-size: 1rem; }
            .stats-cards { 
                flex-direction: column; 
                gap: 1rem; /* Reduzir o gap quando em coluna */
            }
            .stat-card { min-width: unset; } /* Permitir que o card ocupe a largura disponível */
            h2 { font-size: 1.8rem; }
            h3 { font-size: 1.3rem; }
            form { max-width: 100%; }
        }

        /* Para celulares em retrato */
        @media (max-width: 480px) {
            .logo { font-size: 1.4rem; }
            .logo a { font-size: 1.4rem; } /* Ajuste do tamanho da fonte do logo para celulares */
            .hero-section h1 { font-size: 1.8rem; }
            .cta-btn { font-size: 0.9rem; padding: 0.7rem 1.5rem; } 
        } 
    </style>
    <!-- Estilos Adicionais para Botões de Perguntas Pré-definidas no Chat -->
    <style>
        .predefined-question-button {
            background-color: var(--lilas-claro);
            color: var(--lilas-escuro);
            border: 1px solid var(--lilas-principal);
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            width: 100%;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.9em;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        .predefined-question-button:hover {
            background-color: hsl(270, 60%, 90%);
        }
    </style>
    <style>
        /* Chat Widget Styles */
        #chat-widget-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1001; /* Above header */
        }

        #chat-toggle-button {
            background-color: var(--verde-principal);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        #chat-toggle-button:hover {
            background-color: var(--verde-escuro);
            transform: scale(1.1);
        }

        #chat-window {
            width: 350px;
            max-height: 500px;
            background-color: var(--branco);
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            display: flex; /* Initially none, controlled by JS */
            flex-direction: column;
            overflow: hidden;
            position: absolute;
            bottom: 80px; /* Above the toggle button */
            right: 0;
        }

        #chat-header {
            background-color: var(--verde-principal);
            color: white;
            padding: 15px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #chat-close-window-button {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
        }

        #chat-messages {
            flex-grow: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: var(--cinza-fundo);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .chat-message {
            padding: 10px 15px;
            border-radius: 18px;
            max-width: 80%;
            line-height: 1.4;
            word-wrap: break-word;
        }

        .chat-message.user {
            background-color: var(--lilas-principal);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .chat-message.bot {
            background-color: #e9e9eb; /* Um cinza claro neutro */
            color: var(--cinza-texto);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .chat-message .timestamp {
            font-size: 0.75em;
            display: block;
            margin-top: 5px;
            text-align: right;
        }
        .chat-message.bot .timestamp {
            color: rgba(0,0,0,0.5); 
        }
        .chat-message.user .timestamp {
            color: rgba(255,255,255,0.7);
        }

        #chat-input-area {
            display: flex;
            padding: 10px;
            border-top: 1px solid #eee;
            background-color: var(--branco);
        }

        #chat-input {
            flex-grow: 1;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 10px 15px;
            font-size: 14px;
            margin-right: 10px;
        }

        #chat-input:focus {
            outline: none;
            border-color: var(--verde-principal);
            box-shadow: 0 0 0 2px var(--verde-claro);
        }

        #chat-send-button {
            background-color: var(--verde-principal);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        #chat-send-button:hover {
            background-color: var(--verde-escuro);
        }

        /* Estilos para botões de ação dentro das mensagens do bot */
        .chat-action-buttons-container {
            margin-top: 10px;
            display: flex;
            gap: 8px;
            flex-wrap: wrap; /* Permite que os botões quebrem linha se necessário */
        }

        .chat-action-button {
            background-color: hsl(270, 60%, 92%); /* Lilás um pouco mais suave que o predefined-question-button */
            color: var(--lilas-escuro);
            border: 1px solid hsl(270, 50%, 75%); /* Borda lilás mais suave */
            padding: 6px 12px;
            border-radius: 15px; /* Mais arredondado */
            cursor: pointer;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.8em;
            transition: background-color 0.2s ease, color 0.2s ease;
        }
        .chat-action-button:hover {
            background-color: hsl(270, 60%, 85%);
        }
    </style>
</head>
<body>
    <header>
        <!-- Conteúdo do Cabeçalho: Logo, Navegação, Seletor de Idioma, Botão de Menu Mobile -->
        <div class="header-content">
            <div class="logo">
                <a href="#home" onclick="navigateToSection('home'); return false;" aria-label="Ir para o início" data-aria-es="Ir para o início" data-aria-en="Go to home" data-aria-pt="Ir para o início">
                    Multiagro
                </a>
            </div>
            <nav>
                <ul id="nav-links">
                    <li><a href="#home" class="active nav-link" data-lang-es="Inicio" data-lang-en="Home" data-lang-pt="Início">Inicio</a></li>
                    <!-- Outros links de navegação com atributos data-lang-* para internacionalização -->
                    <li><a href="#productos" class="nav-link" data-lang-es="Productos" data-lang-en="Products" data-lang-pt="Produtos">Productos</a></li>
                    <li><a href="#nosotros" class="nav-link" data-lang-es="Nosotros" data-lang-en="About Us" data-lang-pt="Sobre Nós">Nosotros</a></li>
                    <li><a href="#gobernanza" class="nav-link" data-lang-es="Gobernanza" data-lang-en="Governance" data-lang-pt="Governança">Gobernanza</a></li>
                    <li><a href="#sostenibilidad" class="nav-link" data-lang-es="Sostenibilidad" data-lang-en="Sustainability" data-lang-pt="Sustentabilidade">Sostenibilidad</a></li>
                    <li><a href="#contacto" class="nav-link" data-lang-es="Contacto" data-lang-en="Contact" data-lang-pt="Contato">Contacto</a></li>
                    <li><a href="#inversionistas" class="nav-link nav-link-investor" data-lang-es="Inversionistas" data-lang-en="Investors" data-lang-pt="Investidores">Inversionistas</a></li>
                    <li class="language-switcher">
                        <!-- Botões para trocar o idioma da página -->
                        <button id="lang-es" class="active-lang">ES</button>
                        <button id="lang-en">EN</button>
                        <button id="lang-pt">PT</button>
                    </li>
                </ul>
            </nav>
            <!-- Atributos data-aria-* para acessibilidade do menu toggle em diferentes idiomas -->
            <button class="menu-toggle"
                    data-aria-open-es="Abrir menú" data-aria-open-en="Open menu" data-aria-open-pt="Abrir menu"
                    data-aria-close-es="Cerrar menú" data-aria-close-en="Close menu" data-aria-close-pt="Fechar menu"
                    aria-label="Abrir menú">☰</button> <!-- O texto '☰' é o ícone do menu hambúrguer -->
        </div>
    </header>

    <main>
        <!-- Sección de Hero/Principal -->
        <!-- A classe 'hero-section' é a seção principal no topo da página -->
        <section id="home" class="hero-section"> 

                                        <!-- Container do Vídeo movido para cá -->
                <div class="video-background-container">
                    <video autoplay loop muted playsinline poster="images/placeholder_video.jpg">
                        <source src="videos/video8.mp4" type="video/mp4">
                        Seu navegador não suporta o elemento de vídeo.
                    </video>
                </div>
            <div id="home-content-placeholder"></div>
        </section>

        <!-- Seção Produtos -->
        <section id="productos"><div id="productos-content-placeholder"></div></section>
        <!-- Sobre Nosotros -->
        <section id="nosotros"><div id="nosotros-content-placeholder"></div></section>

        <!-- Gobernanza Corporativa -->
        <section id="gobernanza"><div id="gobernanza-content-placeholder"></div></section>

        <!-- Relación com Inversionistas -->
        <section id="inversionistas"><div id="inversionistas-content-placeholder"></div></section>

        <!-- Comunicados -->
        <section id="comunicados"><div id="comunicados-content-placeholder"></div></section>

        <!-- Sostenibilidad -->
        <section id="sostenibilidad"><div id="sostenibilidad-content-placeholder"></div></section>

        <!-- Contacto -->
        <section id="contacto"><div id="contacto-content-placeholder"></div></section>
    </main>

    <footer>
        <!-- Conteúdo do rodapé: informações da empresa, direitos autorais, links úteis -->
        <p data-lang-es="Multiagro S.A. | RUC: 80050297-3" data-lang-en="Multiagro S.A. | Tax ID: 80050297-3" data-lang-pt="Multiagro S.A. | CNPJ/RUC: 80050297-3">Multiagro S.A. | RUC: 80050297-3</p>
        <p><span data-lang-es="Sede: Guajayvi, San Pedro, Paraguay" data-lang-en="Headquarters: Guajayvi, San Pedro, Paraguay" data-lang-pt="Sede: Guajayvi, San Pedro, Paraguai">Sede: Guajayvi, San Pedro, Paraguay</span> | © <span id="currentYear"></span> Multiagro S.A. <span data-lang-es="Todos los derechos reservados." data-lang-en="All rights reserved." data-lang-pt="Todos os direitos reservados.">Todos los derechos reservados.</span></p>
        <div class="footer-links">
            <a href="#inversionistas" onclick="navigateToSection('inversionistas');return false;" data-lang-es="Inversionistas" data-lang-en="Investors" data-lang-pt="Investidores">Inversionistas</a> |
            <!-- Outros links no rodapé -->
            <a href="#sostenibilidad" onclick="navigateToSection('sostenibilidad');return false;" data-lang-es="Sostenibilidad" data-lang-en="Sustainability" data-lang-pt="Sustentabilidade">Sostenibilidad</a> |
            <a href="/docs/politica-privacidad-multiagro.pdf" target="_blank" data-lang-es="Política de Privacidad" data-lang-en="Privacy Policy" data-lang-pt="Política de Privacidade">Política de Privacidad</a>
            
            <!-- Ícones de Redes Sociais no Rodapé -->
            <a href="https://www.linkedin.com/company/multiagro-superfoods" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn da Multiagro" style="margin-left: 1.5rem;"> <!-- Margem para separar dos links de texto -->
                <i class="fab fa-linkedin"></i>
            </a>
            <a href="https://www.facebook.com/profile.php?id=61577928593848" target="_blank" rel="noopener noreferrer" aria-label="Facebook da Multiagro">
                <i class="fab fa-facebook-square"></i>
            </a>
            <a href="https://www.instagram.com/multiagropy/" target="_blank" rel="noopener noreferrer" aria-label="Instagram da Multiagro">
                <i class="fab fa-instagram"></i>
            </a>
        </div>
    </footer>

    <!-- Chatbot Widget HTML -->
    <div id="chat-widget-container">
        <button id="chat-toggle-button" aria-label="Abrir chat">
            <span class="chat-icon">💬</span>
            <span class="chat-close-icon" style="display:none;">✕</span>
        </button>
        <div id="chat-window" style="display:none;">
            <div id="chat-header">
                Chat Multiagro
                <button id="chat-close-window-button" aria-label="Fechar chat">✕</button>
            </div>
            <div id="chat-messages"></div>
            <div id="chat-input-area">
                <input type="text" id="chat-input" placeholder="Digite sua dúvida...">
                <button id="chat-send-button" data-lang-es="Enviar" data-lang-en="Send" data-lang-pt="Enviar">Enviar</button>
                <button id="chat-show-predefined-button" style="display:none; margin-left: 5px; padding: 10px 15px; background-color: var(--lilas-claro); color: var(--lilas-escuro); border: 1px solid var(--lilas-principal); border-radius: 20px; cursor: pointer; font-size: 13px;" data-lang-es="Preguntas Principales" data-lang-en="Main Questions" data-lang-pt="Perguntas Principais">Perguntas Principais</button>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
       integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
       crossorigin=""></script>
    <script>
        // New map to store loaded section content
        const loadedSectionContent = new Map();

        let currentLang; // Declare here for broader scope

        // Global variable for TradingView locale
        window.tvLocale = 'es'; // Default

        async function loadSectionContent(sectionId) {
            const sectionElement = document.getElementById(sectionId);
            if (!sectionElement) {
                console.error(`Section element with ID '${sectionId}' not found.`);
                return;
            }

            // Use a placeholder div inside the section to load content
            let contentPlaceholder = sectionElement.querySelector(`#${sectionId}-content-placeholder`);
            if (!contentPlaceholder) {
                contentPlaceholder = document.createElement('div');
                contentPlaceholder.id = `${sectionId}-content-placeholder`;
                sectionElement.appendChild(contentPlaceholder);
            }

            // Check if content is already loaded
            if (loadedSectionContent.has(sectionId)) {
                contentPlaceholder.innerHTML = loadedSectionContent.get(sectionId);
                // Re-execute scripts for already loaded content
                executeScriptsInElement(contentPlaceholder);
                return;
            }

            const filePath = `sections/${sectionId}.html`;
            try {
                const response = await fetch(filePath);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const htmlContent = await response.text();
                contentPlaceholder.innerHTML = htmlContent;
                loadedSectionContent.set(sectionId, htmlContent); // Store content

                // Execute scripts within the newly loaded content
                executeScriptsInElement(contentPlaceholder);

            } catch (error) {
                console.error(`Failed to load section content for ${sectionId}:`, error);
                contentPlaceholder.innerHTML = `<p>Error loading content for ${sectionId}. Please try again later.</p>`;
            }
        }

        function executeScriptsInElement(element) {
            const scripts = element.querySelectorAll('script');
            scripts.forEach(oldScript => {
                const newScript = document.createElement('script');
                Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));
                newScript.textContent = oldScript.textContent;
                // Replace the old script with the new one to ensure execution
                if (oldScript.parentNode) {
                    oldScript.parentNode.replaceChild(newScript, oldScript);
                } else {
                    // If script is not attached to DOM (e.g., in a fragment), append it to body to execute
                    document.body.appendChild(newScript);
                    newScript.remove(); // Remove immediately after execution if not needed in DOM
                }
            });
        }

        // --- Hero Carousel Logic ---
        function initializeHeroCarousel() {
            const heroCarousel = document.querySelector('.hero-section .hero-carousel');
            if (heroCarousel) {
                const slidesContainer = heroCarousel.querySelector('.carousel-slides');
                const slides = heroCarousel.querySelectorAll('.carousel-slide');
                const prevButton = heroCarousel.querySelector('.carousel-prev');
                const nextButton = heroCarousel.querySelector('.carousel-next');
                let currentSlideIndex = 0;
                const slideIntervalTime = 7000; // 7 seconds for auto-slide
                let slideTimer;

                function goToSlide(index) {
                    if (!slidesContainer || slides.length === 0) return;
                    slidesContainer.style.transform = `translateX(-${index * 100}%)`;
                    currentSlideIndex = index;
                }

                function nextSlideAuto() {
                    let newIndex = currentSlideIndex + 1;
                    if (newIndex >= slides.length) newIndex = 0;
                    goToSlide(newIndex);
                }

                function startSlideTimer() {
                    if (slides.length > 1) {
                        clearInterval(slideTimer); // Clear existing timer before starting a new one
                        slideTimer = setInterval(nextSlideAuto, slideIntervalTime);
                    }
                }

                if (prevButton && nextButton && slides.length > 0) {
                    prevButton.addEventListener('click', () => {
                        currentSlideIndex = (currentSlideIndex - 1 + slides.length) % slides.length;
                        goToSlide(currentSlideIndex);
                        startSlideTimer(); // Reset timer on manual navigation
                    });

                    nextButton.addEventListener('click', () => {
                        currentSlideIndex = (currentSlideIndex + 1) % slides.length;
                        goToSlide(currentSlideIndex);
                        startSlideTimer(); // Reset timer on manual navigation
                    });
                }
                if (slides.length > 0) { // Initialize and start timer if slides exist
                    goToSlide(0);
                    startSlideTimer();
                    heroCarousel.addEventListener('mouseenter', () => clearInterval(slideTimer));
                    heroCarousel.addEventListener('mouseleave', startSlideTimer);
                }
            }
        }

        // --- Leaflet Map Initialization ---
        let mapInstance = null; // Para manter referência ao mapa e poder removê-lo se necessário

        function initLeafletMap() {
            if (mapInstance) {
                mapInstance.remove(); // Remove o mapa anterior para evitar duplicação
                mapInstance = null;
            }

            // Inicializa o mapa sem setView, pois fitBounds cuidará disso
            mapInstance = L.map('mapid'); 
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(mapInstance);

            const countries = [
                // País de Origem
                { nameEs: 'Paraguay', nameEn: 'Paraguay', namePt: 'Paraguai', lat: -23.4425, lng: -58.4438, status: 'origem', radius: 10 },
                // Países Atendidos
                { nameEs: 'Brasil', nameEn: 'Brazil', namePt: 'Brasil', lat: -14.2350, lng: -51.9253, status: 'atendido', radius: 8 },
                { nameEs: 'Argentina', nameEn: 'Argentina', namePt: 'Argentina', lat: -38.4161, lng: -63.6167, status: 'atendido', radius: 8 },
                { nameEs: 'Bolivia', nameEn: 'Bolivia', namePt: 'Bolívia', lat: -16.2902, lng: -63.5887, status: 'atendido', radius: 7 },
                { nameEs: 'Chile', nameEn: 'Chile', namePt: 'Chile', lat: -35.6751, lng: -71.5430, status: 'atendido', radius: 7 },
                { nameEs: 'México', nameEn: 'Mexico', namePt: 'México', lat: 23.6345, lng: -102.5528, status: 'atendido', radius: 7 },
                { nameEs: 'Colombia', nameEn: 'Colombia', namePt: 'Colômbia', lat: 4.5709, lng: -74.2973, status: 'atendido', radius: 7 },
                // Países em Negociação
                { nameEs: 'Estados Unidos', nameEn: 'United States', namePt: 'Estados Unidos', lat: 37.0902, lng: -95.7129, status: 'negociacao', radius: 8 },
                { nameEs: 'China', nameEn: 'China', namePt: 'China', lat: 35.8617, lng: 104.1954, status: 'negociacao', radius: 8 },
                { nameEs: 'España', nameEn: 'Spain', namePt: 'Espanha', lat: 40.4637, lng: -3.7492, status: 'negociacao', radius: 7 },
                { nameEs: 'Francia', nameEn: 'France', namePt: 'França', lat: 46.2276, lng: 2.2137, status: 'negociacao', radius: 7 },
                { nameEs: 'Portugal', nameEn: 'Portugal', namePt: 'Portugal', lat: 39.3999, lng: -8.2245, status: 'negociacao', radius: 7 }
            ];
            const markersArray = []; // Array para armazenar os marcadores

            countries.forEach(country => {
                let popupName = country.nameEs; // Padrão para espanhol
                if (currentLang === 'en') popupName = country.nameEn;
                else if (currentLang === 'pt') popupName = country.namePt;

                let markerColor;
                if (country.status === 'origem') {
                    markerColor = '#1e824c'; // Verde escuro
                } else if (country.status === 'atendido') {
                    markerColor = '#8816bd'; // Azul
                } else { // 'negociacao'
                    markerColor = '#fd7e14'; // Laranja
                }

                const circle = L.circleMarker([country.lat, country.lng], {
                    color: markerColor,
                    fillColor: markerColor,
                    fillOpacity: 0.7,
                    radius: country.radius,
                    weight: country.status === 'origem' ? 3 : 1.5, // Destaque para origem
                    stroke: true
                })
                .addTo(mapInstance)
                .bindPopup(popupName);
                markersArray.push(circle);
            });

            if (markersArray.length > 0) {
                const group = new L.featureGroup(markersArray);
                mapInstance.fitBounds(group.getBounds().pad(0.1)); // pad(0.1) adiciona 10% de margem
            } else {
                // Fallback se não houver marcadores, centraliza de forma genérica
                mapInstance.setView([-15, -50], 3); 
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            // Seletores de elementos do DOM
            const navLinksContainer = document.getElementById('nav-links');
            const navLinks = navLinksContainer.querySelectorAll('a.nav-link');
            const menuToggle = document.querySelector('.menu-toggle');
            const sections = document.querySelectorAll('main section');
            // Objeto para armazenar os botões de idioma
            const langButtons = {
                es: document.getElementById('lang-es'),
                en: document.getElementById('lang-en'),
                pt: document.getElementById('lang-pt')
            };
            currentLang = localStorage.getItem('preferredLang') || 'es';

            // --- Lógica para mostrar/ocultar a Seção Hero ---
            // A seção Hero (home) só deve ser visível na página inicial.
            const HERO_SECTION_ELEMENT_ID = 'home'; // ID da seção hero/principal
            const HIDE_HERO_ON_SUBPAGE_CLASS = 'hero-hidden-on-subpage'; // Classe CSS para ocultar
            const heroSectionElement = document.getElementById(HERO_SECTION_ELEMENT_ID);

            function updateHeroSectionVisibilityBasedOnHash() {
                // Verifica o hash da URL para determinar se a seção Hero deve ser exibida.
                if (!heroSectionElement) {
                    console.warn(`Elemento da seção Hero com ID '${HERO_SECTION_ELEMENT_ID}' não encontrado para visibilidade condicional.`);
                    return;
                }
                // Considera "home" se o hash for vazio, #, ou #home
                const currentHash = window.location.hash.substring(1).toLowerCase();
                const homePageHashes = ['', 'home']; 

                if (homePageHashes.includes(currentHash)) {
                    heroSectionElement.classList.remove(HIDE_HERO_ON_SUBPAGE_CLASS);
                } else {
                    heroSectionElement.classList.add(HIDE_HERO_ON_SUBPAGE_CLASS);
                }
            }

            // --- Atualiza o aria-label do botão de menu (hambúrguer) ---
            function updateMenuToggleAriaLabel() {
                // Define o texto do aria-label com base no idioma atual e se o menu está aberto ou fechado.
                if (!menuToggle) return;
                const isOpen = navLinksContainer.classList.contains('active');
                const attrPrefix = isOpen ? 'data-aria-close-' : 'data-aria-open-';
                const ariaLabelText = menuToggle.getAttribute(attrPrefix + currentLang);
                if (ariaLabelText) {
                    menuToggle.setAttribute('aria-label', ariaLabelText);
                } else { 
                    const fallbackAriaLabel = menuToggle.getAttribute(attrPrefix + 'es');
                    if (fallbackAriaLabel) menuToggle.setAttribute('aria-label', fallbackAriaLabel);
                }
            }

            // --- Lógica do Seletor de Idioma ---
            function setLanguage(lang) {
                // Define o idioma atual, salva no localStorage e atualiza todos os textos da página.
                currentLang = lang;
                localStorage.setItem('preferredLang', lang);

                document.documentElement.lang = lang; // Update html lang attribute

                // Update button active state
                langButtons.es.classList.toggle('active-lang', lang === 'es');
                langButtons.en.classList.toggle('active-lang', lang === 'en');
                langButtons.pt.classList.toggle('active-lang', lang === 'pt');

                // Update page title
                const pageTitleData = document.querySelector('head title');
                if (pageTitleData) {
                    const titleText = pageTitleData.getAttribute(`data-lang-${lang}`);
                    // Update chat button texts based on language
                    const chatSendBtn = document.getElementById('chat-send-button');
                    const chatShowPredefinedBtn = document.getElementById('chat-show-predefined-button');
                    if(chatSendBtn) chatSendBtn.textContent = chatSendBtn.getAttribute(`data-lang-${lang}`) || chatSendBtn.textContent;
                    if(chatShowPredefinedBtn) chatShowPredefinedBtn.textContent = chatShowPredefinedBtn.getAttribute(`data-lang-${lang}`) || chatShowPredefinedBtn.textContent;
                // Note: i18n for inline action buttons will be handled when they are created.
                    if (titleText) document.title = titleText;
                }

                // Update global tvLocale for TradingView widget
                if (lang === 'en') window.tvLocale = 'en';
                else if (lang === 'pt') window.tvLocale = 'br'; // TradingView uses 'br' for Portuguese
                else window.tvLocale = 'es'; // Default for 'es'

                // Atualiza o conteúdo de texto para todos os elementos com atributos data-lang-*
                document.querySelectorAll('[data-lang-es]').forEach(el => {
                    if (el.tagName === 'TITLE') return; // Skip title tag as it's handled above
                    const text = el.getAttribute(`data-lang-${lang}`);
                    if (text) {
                        if (el.dataset.allowHtml || (el.innerHTML.includes('<') && el.innerHTML.includes('>'))) { // Check for a marker or existing HTML
                            el.innerHTML = text;
                        } else {
                            el.textContent = text;
                        }
                    }
                });
                 // Atualiza os placeholders de inputs e textareas
                document.querySelectorAll('input[data-placeholder-es], textarea[data-placeholder-es]').forEach(el => {
                    const placeholderText = el.getAttribute(`data-placeholder-${lang}`);
                    if (placeholderText) {
                        el.setAttribute('placeholder', placeholderText);
                    }
                });

                // Atualiza os atributos 'alt' das imagens
                document.querySelectorAll('img[data-alt-es]').forEach(el => {
                    const altText = el.getAttribute(`data-alt-${lang}`);
                    if (altText) el.setAttribute('alt', altText);
                });

                // Atualiza os atributos 'aria-label'
                document.querySelectorAll('[data-aria-es]').forEach(el => {
                    const ariaLabelText = el.getAttribute(`data-aria-${lang}`);
                    if (ariaLabelText) el.setAttribute('aria-label', ariaLabelText);
                });
                 // Atualiza os atributos 'title' (ex: para iframes)
                document.querySelectorAll('[data-title-es]').forEach(el => {
                    const titleText = el.getAttribute(`data-title-${lang}`);
                    if (titleText) el.setAttribute('title', titleText);
                });
                
                // Update aria-labels for hero carousel buttons if they exist
                const heroCarouselElem = document.querySelector('.hero-section .hero-carousel');
                if (heroCarouselElem) {
                    const prevBtn = heroCarouselElem.querySelector('.carousel-prev');
                    const nextBtn = heroCarouselElem.querySelector('.carousel-next');
                    if (prevBtn) {
                        const prevAria = prevBtn.getAttribute(`data-aria-${lang}`) || prevBtn.getAttribute('data-aria-es');
                        if (prevAria) prevBtn.setAttribute('aria-label', prevAria);
                    }
                    if (nextBtn) {
                        const nextAria = nextBtn.getAttribute(`data-aria-${lang}`) || nextBtn.getAttribute('data-aria-es');
                        if (nextAria) nextBtn.setAttribute('aria-label', nextAria);
                    }
                }

                updateMenuToggleAriaLabel();
            }

            // Adiciona event listeners aos botões de idioma
            langButtons.es.addEventListener('click', () => setLanguage('es'));
            langButtons.en.addEventListener('click', () => setLanguage('en'));
            langButtons.pt.addEventListener('click', () => setLanguage('pt'));
            
            // --- Menu Hambúrguer ---
            menuToggle.addEventListener('click', () => {
                navLinksContainer.classList.toggle('active');
                menuToggle.textContent = navLinksContainer.classList.contains('active') ? '✕' : '☰';
                updateMenuToggleAriaLabel();
            });

            // Adiciona event listeners aos links de navegação para a navegação SPA
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    navigateToSection(targetId);
                });
            });

            // --- Função para mostrar a seção correta na interface ---
            async function showSectionUI(id) {
                // Oculta todas as seções
                sections.forEach(s => s.classList.remove('visible'));

                // Load content for the target section
                await loadSectionContent(id); // Wait for content to load

                const targetSection = document.getElementById(id);
                if (targetSection) {
                    targetSection.classList.add('visible');

                    // If 'home' is activated, also load and show 'productos'
                    if (id === 'home') {
                        await loadSectionContent('productos');
                        const productosSection = document.getElementById('productos');
                        if (productosSection) {
                            productosSection.classList.add('visible');
                        }
                        initializeHeroCarousel(); // Initialize carousel after home content is loaded
                    }

                    // Initialize map if 'nosotros' section is now visible and map elements are ready
                    if (id === 'nosotros' && document.getElementById('mapid') && typeof L !== 'undefined') {
                        initLeafletMap();
                    }
                }
                // Re-apply language after content is loaded
                setLanguage(currentLang);
            }

            // --- Função para atualizar a visualização da página com base no hash da URL ---
            async function refreshViewForCurrentHash() {
                // Controla a visibilidade da seção Hero e mostra a seção principal correta.
                updateHeroSectionVisibilityBasedOnHash(); // Controla visibilidade da hero section

                let sectionIdFromHash = window.location.hash ? window.location.hash.substring(1) : 'home';
                if (!document.getElementById(sectionIdFromHash)) { // Fallback se hash for inválido
                    sectionIdFromHash = 'home';
                }
                
                await showSectionUI(sectionIdFromHash); // Mostra a seção principal

                // Atualiza links ativos na navegação e estado do menu mobile
                navLinks.forEach(a => a.classList.remove('active'));
                const activeLink = document.querySelector(`nav a[href="#${sectionIdFromHash}"]`);
                if (activeLink) activeLink.classList.add('active');
                
                // Fecha menu mobile se estiver aberto
                if (navLinksContainer.classList.contains('active')) {
                    navLinksContainer.classList.remove('active');
                    menuToggle.textContent = '☰';
                    updateMenuToggleAriaLabel(); // Adicionado para consistência
                }
            }

            // --- Lógica de Navegação SPA (Single Page Application) ---
            window.navigateToSection = async function(targetId) { // Expor globalmente para onclicks
                if (history.pushState) {
                    history.pushState(null, null, `#${targetId}`);
                } else {
                    window.location.hash = `#${targetId}`;
                }
                await refreshViewForCurrentHash(); // Atualiza a visualização completa
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
            
            // --- Carregamento Inicial ---
            // Função chamada quando a página é carregada pela primeira vez.
            async function loadInitialViewRevised() {
                await refreshViewForCurrentHash();
                setLanguage(currentLang); // Aplicar idioma salvo/padrão após o carregamento inicial
            }

            loadInitialViewRevised();

            // --- Manipulador para navegação de voltar/avançar do navegador ---
            window.addEventListener('popstate', async () => {
                // Reaplicar o idioma e atualizar a visualização quando o usuário navega pelo histórico.
                await refreshViewForCurrentHash(); // Atualizar visualização para o novo hash
            }); 

            // --- Define o ano atual no rodapé ---
            document.getElementById('currentYear').textContent = new Date().getFullYear();

            // --- Manipulador simples para o formulário de contato ---
            // Exibe um alerta de confirmação e reseta o formulário.
            const contactForm = document.getElementById('contactForm');
            if(contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    let msg = '';
                    if (currentLang === 'es') {
                        msg = '¡Gracias por su mensaje! Nos pondremos en contacto pronto.';
                    } else if (currentLang === 'en') {
                        msg = 'Thank you for your message! We will contact you soon.';
                    } else if (currentLang === 'pt') {
                        msg = 'Obrigado pela sua mensagem! Entraremos em contato em breve.';
                    }
                    alert(msg);
                    this.reset();
                });
            }
        });
        
        // Simulated Chatbot Logic
        const chatToggleButton = document.getElementById('chat-toggle-button');
        const chatWindow = document.getElementById('chat-window');
        const chatMessagesContainer = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        const chatSendButton = document.getElementById('chat-send-button');
        const chatCloseWindowButton = document.getElementById('chat-close-window-button');
        const chatIcon = chatToggleButton.querySelector('.chat-icon');
        const chatCloseIcon = chatToggleButton.querySelector('.chat-close-icon');
        const chatShowPredefinedButton = document.getElementById('chat-show-predefined-button');

        let isChatOpen = false; // Inicia como falso, será aberto programaticamente

        const predefinedQAs = [
            {
                id: 'products_overview',
                questionText: "Quais são seus principais produtos?",
                botResponse: "Nossas principais linhas são: \n1. Beneficiamento de Grãos: Chía, Feijão Mungo, Gergelim, Sorgo, Milho e Soja. \n2. Alimentos Don Luís: Café, Açúcar e Cereais selecionados. \n3. Nutrição Animal (em breve!). \nVeja detalhes na seção 'Productos'."
            },
            {
                id: 'contact_info',
                questionText: "Como posso entrar em contato?",
                botResponse: "Para contato geral, use o formulário na seção 'Contacto' ou o e-mail info@multiagro.com.py. Para investidores, o e-mail é invest@multiagro.com.py. Nosso telefone é +595 XXX XXX XXX e estamos em Guajayvi, San Pedro, Paraguai."
            },
            {
                id: 'about_multiagro',
                questionText: "Conte-me mais sobre a Multiagro.",
                botResponse: "A Multiagro, desde 2004 em Guajayvi, Paraguai, é especialista no beneficiamento, comercialização e exportação de grãos, com foco em superalimentos e produtos orgânicos. Nossa missão é conectar a produção paraguaia ao mundo com qualidade e inovação. Mais em 'Nosotros'."
            },
            {
                id: 'investor_info',
                questionText: "Informações para Investidores?",
                botResponse: "A Multiagro S.A. está listada na Bolsa de Valores de Asunción (BVPASA). Na seção 'Inversionistas', você encontra nosso foco estratégico, relatórios, e informações sobre como participar do futuro da agroindústria paraguaia."
            },
            {
                id: 'sustainability_info',
                questionText: "Qual o compromisso com a sustentabilidade?",
                botResponse: "A sustentabilidade é um pilar! Focamos no ambiental (boas práticas agrícolas), social (apoio a produtores de Guajayvi) e governança (ética e transparência). Detalhes na seção 'Sostenibilidad'."
            },
            {
                id: 'export_markets',
                questionText: "Vocês exportam para quais mercados?",
                botResponse: "Sim, exportamos para diversos mercados globais, incluindo países da América Latina, e estamos em negociação com EUA, China e Europa. Veja nosso mapa de presença global no final da seção 'Nosotros'."
            }
        ];

        function removePredefinedQuestions() {
            const containerToRemove = document.getElementById('predefined-questions-container');
            if (containerToRemove) {
                containerToRemove.remove();
                if (chatShowPredefinedButton && isChatOpen) {
                    chatShowPredefinedButton.style.display = 'inline-block';
                }
            }
        }

        function toggleChatWindow() {
            isChatOpen = !isChatOpen;
            const currentSiteLang = localStorage.getItem('preferredLang') || 'es';
            const openChatLabel = currentSiteLang === 'pt' ? 'Fechar chat' : (currentSiteLang === 'en' ? 'Close chat' : 'Cerrar chat');
            const closeChatLabel = currentSiteLang === 'pt' ? 'Abrir chat' : (currentSiteLang === 'en' ? 'Open chat' : 'Abrir chat');

            if (isChatOpen) {
                chatWindow.style.display = 'flex';
                chatIcon.style.display = 'none';
                chatCloseIcon.style.display = 'inline';
                chatToggleButton.setAttribute('aria-label', openChatLabel);
                if (chatMessagesContainer.children.length === 0) { 
                    addBotMessage("Olá! 👋 Sou o assistente virtual da Multiagro. Como posso ajudar você hoje?", { addActionButtons: false });
                    displayPredefinedQuestions();
                } else {
                    if (!document.getElementById('predefined-questions-container') && chatShowPredefinedButton) {
                        chatShowPredefinedButton.style.display = 'inline-block';
                    } else if (chatShowPredefinedButton) {
                         chatShowPredefinedButton.style.display = 'none';
                    }
                }
            } else {
                chatWindow.style.display = 'none';
                chatIcon.style.display = 'inline';
                chatCloseIcon.style.display = 'none';
                chatToggleButton.setAttribute('aria-label', closeChatLabel);
                if (chatShowPredefinedButton) {
                    chatShowPredefinedButton.style.display = 'none';
                }
            }
        }

        if (chatToggleButton) chatToggleButton.addEventListener('click', toggleChatWindow);
        if (chatCloseWindowButton) chatCloseWindowButton.addEventListener('click', toggleChatWindow);

        function getCurrentTime() {
            return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
        }

        function removeBotActionButtons() {
            const actionButtonContainers = chatMessagesContainer.querySelectorAll('.chat-action-buttons-container');
            actionButtonContainers.forEach(container => container.remove());
        }

        function addMessageToChat(message, sender, options = {}) {
            if (sender === 'bot') { // Only remove action buttons before adding a new bot message.
                removeBotActionButtons();
            }

            const messageDiv = document.createElement('div');
            messageDiv.classList.add('chat-message', sender);
            
            const messageText = document.createElement('span');
            messageText.innerHTML = message; // Use innerHTML to allow line breaks like \n to be <br>
            messageDiv.appendChild(messageText);
            const timestampSpan = document.createElement('span');
            timestampSpan.classList.add('timestamp');
            timestampSpan.textContent = getCurrentTime();
            messageDiv.appendChild(timestampSpan);
            
            chatMessagesContainer.appendChild(messageDiv);
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;

            // Add action buttons if it's a bot message and addActionButtons is true
            if (sender === 'bot' && options.addActionButtons) {
                const currentSiteLang = localStorage.getItem('preferredLang') || 'es';
                const actionsContainer = document.createElement('div');
                actionsContainer.classList.add('chat-action-buttons-container');

                const backButton = document.createElement('button');
                backButton.classList.add('chat-action-button');
                backButton.setAttribute('data-lang-pt', "Voltar às perguntas principais");
                backButton.setAttribute('data-lang-en', "Back to main questions");
                backButton.setAttribute('data-lang-es', "Volver a preguntas principales");
                backButton.textContent = backButton.getAttribute(`data-lang-${currentSiteLang}`) || backButton.getAttribute('data-lang-pt');
                backButton.addEventListener('click', () => {
                    let msg;
                    if (currentSiteLang === 'pt') msg = "Certo! Retornando às perguntas principais:";
                    else if (currentSiteLang === 'en') msg = "Okay! Returning to the main questions:";
                    else msg = "¡Claro! Volviendo a las preguntas principales:";
                    addBotMessage(msg, { addActionButtons: false });
                    displayPredefinedQuestions();
                });

                const endButton = document.createElement('button');
                endButton.classList.add('chat-action-button');
                endButton.setAttribute('data-lang-pt', "Encerrar chat");
                endButton.setAttribute('data-lang-en', "End chat");
                endButton.setAttribute('data-lang-es', "Cerrar chat");
                endButton.textContent = endButton.getAttribute(`data-lang-${currentSiteLang}`) || endButton.getAttribute('data-lang-pt');
                endButton.addEventListener('click', () => {
                    toggleChatWindow(); // This will also hide the chatShowPredefinedButton
                });

                actionsContainer.appendChild(backButton);
                actionsContainer.appendChild(endButton);
                messageDiv.appendChild(actionsContainer); // Append to the message div itself
                chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
            }
        }


        function addBotMessage(message, options = { addActionButtons: true }) {
            // Replace \n with <br> for HTML display
            const formattedMessage = message.replace(/\n/g, '<br>');
            addMessageToChat(formattedMessage, 'bot', options);
        }

        function addUserMessage(message) {
            const formattedMessage = message.replace(/\n/g, '<br>');
            addMessageToChat(formattedMessage, 'user');
        }

        function displayPredefinedQuestions() {
            // Remove qualquer conjunto anterior de perguntas para evitar duplicatas
            removePredefinedQuestions();

            const questionsContainer = document.createElement('div');
            questionsContainer.id = 'predefined-questions-container';
            questionsContainer.style.padding = '5px 0px 10px 0px'; // Ajuste no padding
            questionsContainer.style.display = 'flex';
            questionsContainer.style.flexDirection = 'column';
            questionsContainer.style.gap = '8px';

            predefinedQAs.forEach(qa => {
                const button = document.createElement('button');
                button.textContent = qa.questionText;
                button.classList.add('predefined-question-button'); // Classe para estilização CSS

                button.addEventListener('click', () => {
                    addUserMessage(qa.questionText); 
                    addBotMessage(qa.botResponse); // This will add action buttons by default
                    removePredefinedQuestions(); // Remove os botões após um ser clicado
                });
                questionsContainer.appendChild(button);
            });
            // Adiciona o container de perguntas após a última mensagem (que deve ser a de boas-vindas do bot)
            chatMessagesContainer.appendChild(questionsContainer);
            chatMessagesContainer.scrollTop = chatMessagesContainer.scrollHeight;
            if (chatShowPredefinedButton) chatShowPredefinedButton.style.display = 'none';
        }

        function getSimulatedBotResponse(userMessage) {
            const lowerMessage = userMessage.toLowerCase();

            // Check for direct matches with predefined questions first (more specific)
            if (lowerMessage.includes("quais são seus principais produtos") || lowerMessage.includes("que produtos vocês têm")) {
                return predefinedQAs.find(qa => qa.id === 'products_overview').botResponse;
            }
            if (lowerMessage.includes("como posso entrar em contato") || lowerMessage.includes("fale com vocês")) {
                return predefinedQAs.find(qa => qa.id === 'contact_info').botResponse;
            }
            if (lowerMessage.includes("conte-me mais sobre a multiagro") || lowerMessage.includes("quem é a multiagro")) {
                return predefinedQAs.find(qa => qa.id === 'about_multiagro').botResponse;
            }
            if (lowerMessage.includes("informações para investidores") || lowerMessage.includes("quero investir")) {
                return predefinedQAs.find(qa => qa.id === 'investor_info').botResponse;
            }
            if (lowerMessage.includes("compromisso com a sustentabilidade") || lowerMessage.includes("sustentabilidade na multiagro")) {
                return predefinedQAs.find(qa => qa.id === 'sustainability_info').botResponse;
            }
            if (lowerMessage.includes("exportam para quais mercados") || lowerMessage.includes("para onde exportam")) {
                return predefinedQAs.find(qa => qa.id === 'export_markets').botResponse;
            }

            // General keyword matching
            if (lowerMessage.includes("olá") || lowerMessage.includes("oi") || lowerMessage.includes("bom dia") || lowerMessage.includes("boa tarde") || lowerMessage.includes("boa noite")) {
                return "Olá! 👋 Sou o assistente virtual da Multiagro. Como posso ajudar? Você pode perguntar sobre nossos produtos, contato, ou usar o botão 'Perguntas Principais'.";
            } else if (lowerMessage.includes("produto") || lowerMessage.includes("grão") || lowerMessage.includes("vendem") || lowerMessage.includes("chia") || lowerMessage.includes("mungo") || lowerMessage.includes("gergelim") || lowerMessage.includes("sésamo") || lowerMessage.includes("sorgo") || lowerMessage.includes("milho") || lowerMessage.includes("maíz") || lowerMessage.includes("soja") || lowerMessage.includes("café") || lowerMessage.includes("açúcar") || lowerMessage.includes("cereal") || lowerMessage.includes("ração")) {
                return "Falando em produtos, oferecemos Chía, Feijão Mungo, Gergelim, Sorgo, Milho, Soja, e a linha Don Luís (Café, Açúcar, Cereais). Em breve, teremos Nutrição Animal! Mais detalhes na seção 'Productos'. O que gostaria de saber especificamente?";
            } else if (lowerMessage.includes("contato") || lowerMessage.includes("falar com") || lowerMessage.includes("telefone") || lowerMessage.includes("email") || lowerMessage.includes("endereço")) {
                return "Para contato: e-mail info@multiagro.com.py (geral) ou invest@multiagro.com.py (investidores), telefone +595 XXX XXX XXX. Estamos em Guajayvi, San Pedro, Paraguai. Veja mais na seção 'Contacto'.";
            } else if (lowerMessage.includes("obrigado") || lowerMessage.includes("valeu") || lowerMessage.includes("grato")) {
                return "De nada! Se precisar de mais alguma coisa, é só perguntar ou clique em 'Perguntas Principais'. 😊";
            } else if (lowerMessage.includes("história") || lowerMessage.includes("sobre") || lowerMessage.includes("quem são")) {
                return "A Multiagro, desde 2004, atua em Guajayvi, Paraguai, focada em grãos de qualidade e superalimentos para o mercado nacional e internacional. Conheça nossa missão, visão e valores na seção 'Nosotros'.";
            } else if (lowerMessage.includes("investidor") || lowerMessage.includes("investir") || lowerMessage.includes("ações") || lowerMessage.includes("bolsa") || lowerMessage.includes("bvpasa")) {
                return "Para investidores: A Multiagro S.A. é listada na BVPASA. Detalhes sobre oportunidades, nosso foco estratégico e relatórios estão na seção 'Inversionistas'.";
            } else if (lowerMessage.includes("sustentabilidade") || lowerMessage.includes("meio ambiente") || lowerMessage.includes("social") || lowerMessage.includes("governança")) {
                return "Nosso compromisso com a sustentabilidade envolve práticas ambientais responsáveis, apoio à comunidade de Guajayvi e governança transparente. Saiba mais na seção 'Sostenibilidad'.";
            } else if (lowerMessage.includes("localização") || lowerMessage.includes("onde fica")) {
                return "Nossa sede e planta de processamento estão em Guajayvi, Departamento de San Pedro, Paraguai. Há um mapa na seção 'Contacto'.";
            } else if (lowerMessage.includes("exportação") || lowerMessage.includes("exportam") || lowerMessage.includes("mercados") || lowerMessage.includes("países")) {
                return "Sim, exportamos para diversos países! Conectamos a produção paraguaia com o mundo. Veja nosso mapa de presença global no final da seção 'Nosotros'.";
            } else if (lowerMessage.includes("don luis")) {
                return "A linha Don Luís oferece produtos selecionados como Café, Açúcar e Cereais, levando o melhor do campo para sua mesa. Veja mais na seção 'Productos'.";
            } else if (lowerMessage.includes("orgânico") || lowerMessage.includes("organicos")) {
                return "Sim, temos ampla experiência na comercialização de produtos orgânicos, oferecendo linhas certificadas além dos tradicionais. Consulte-nos para mais detalhes sobre a disponibilidade atual.";
            } else {
                return "Desculpe, não entendi bem. Poderia reformular? Você também pode clicar em 'Perguntas Principais' para ver os tópicos que posso ajudar.";
            }
        }

        function handleSendMessage() {
            const message = chatInput.value.trim();
            if (message) {
                addUserMessage(message);
                removePredefinedQuestions(); // Remove botões de pergunta se o usuário digitar algo
                chatInput.value = ''; 

                setTimeout(() => {
                    const botResponse = getSimulatedBotResponse(message);
                    addBotMessage(botResponse);
                }, 1000 + Math.random() * 1000);
            }
        }

        if (chatShowPredefinedButton) {
            chatShowPredefinedButton.addEventListener('click', () => {
                const currentSiteLang = localStorage.getItem('preferredLang') || 'es';
                let messageText = "Certo! Aqui estão as principais perguntas que posso ajudar a responder:";
                if (currentSiteLang === 'en') messageText = "Okay! Here are the main questions I can help answer:";
                else if (currentSiteLang === 'es') messageText = "¡Claro! Aquí están las principales preguntas que puedo ayudar a responder:";
                
                addBotMessage(messageText, { addActionButtons: false });
                displayPredefinedQuestions();
                // chatShowPredefinedButton.style.display = 'none'; // Already handled by displayPredefinedQuestions
            });
        }

        if (chatSendButton) chatSendButton.addEventListener('click', handleSendMessage);
        if (chatInput) chatInput.addEventListener('keypress', (event) => {
            if (event.key === 'Enter') {
                handleSendMessage();
            }
        });

        // Auto-open chat window on page load (Commented out by default)
        // if (chatToggleButton && chatWindow) {
        //     toggleChatWindow(); // Uncomment to auto-open chat
        // }
    </script>
</body>
</html>
